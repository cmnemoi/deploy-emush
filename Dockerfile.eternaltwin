FROM node:lts-slim

ARG UID=$UID
ARG GID=$GID

WORKDIR /www

RUN apt-get update && apt-get install -y curl

COPY emush/Eternaltwin/package.json ./
COPY eternaltwin.local.toml ./eternaltwin.toml

RUN yarn install --production=false

RUN groupadd -g ${GID} eternaltwin && \
    usermod -u ${UID} -g ${GID} eternaltwin && \
    chown -R eternaltwin:eternaltwin /www

USER eternaltwin

CMD ["yarn", "eternaltwin", "start"]