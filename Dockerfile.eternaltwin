FROM node:lts-slim

ARG UID=$UID
ARG GID=$GID

WORKDIR /www

RUN apt-get update && apt-get install -y curl

COPY emush/Eternaltwin/package.json ./
COPY eternaltwin.local.toml ./eternaltwin.toml

RUN corepack enable && yarn install

RUN usermod -u ${UID} -g ${GID} node && chown -R node:node /www

USER node

CMD ["yarn", "eternaltwin", "start"]